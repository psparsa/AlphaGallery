FROM node:18.0.0-slim

RUN mkdir -p /var/client
WORKDIR /var/client

COPY package.json package-lock.json ./
RUN npm ci

COPY . .

ARG API_PROTOCOL
ENV NEXT_PUBLIC_API_PROTOCOL=$API_PROTOCOL

ARG API_HOSTNAME
ENV NEXT_PUBLIC_API_HOSTNAME=$API_HOSTNAME

ARG API_PORT
ENV NEXT_PUBLIC_API_PORT=$API_PORT

ARG API_ADDRESS_SERVER_SIDE
ENV NEXT_PUBLIC_API_ADDRESS_SERVER_SIDE=$API_ADDRESS_SERVER_SIDE

ARG API_ADDRESS_CLIENT_SIDE
ENV NEXT_PUBLIC_API_ADDRESS_CLIENT_SIDE=$API_ADDRESS_CLIENT_SIDE


RUN npm run build
EXPOSE 3000
CMD [ "npm", "start" ]