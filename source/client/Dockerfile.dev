
FROM node:18.0.0-slim

RUN mkdir -p /var/client
WORKDIR /var/client

COPY package.json package-lock.json ./
RUN npm ci

COPY . .

ARG IMAGE_SERVER_PROTOCOL
ENV NEXT_PUBLIC_IMAGE_SERVER_PROTOCOL=$IMAGE_SERVER_PROTOCOL

ARG IMAGE_SERVER_HOSTNAME
ENV NEXT_PUBLIC_IMAGE_SERVER_HOSTNAME=$IMAGE_SERVER_HOSTNAME

ARG IMAGE_SERVER_PORT
ENV NEXT_PUBLIC_IMAGE_SERVER_PORT=$IMAGE_SERVER_PORT

ARG API_ADDRESS_SERVER_SIDE
ENV NEXT_PUBLIC_API_ADDRESS_SERVER_SIDE=$API_ADDRESS_SERVER_SIDE

ARG API_ADDRESS_CLIENT_SIDE
ENV NEXT_PUBLIC_API_ADDRESS_CLIENT_SIDE=$API_ADDRESS_CLIENT_SIDE


EXPOSE 3000
CMD [ "npm", "run", "dev" ]